<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>Chapter 3 â€“ ë§¥ë¼ë Œ ì´ì ê³¼ ë¼ì´ë²Œì˜ íƒ„ìƒ</title>

  <!-- í°íŠ¸: Pretendard + Shadows Into Light -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link
    href="https://fonts.googleapis.com/css2?family=Pretendard:wght@300;400;500;600&family=Shadows+Into+Light&display=swap"
    rel="stylesheet"
  />

  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      background: #000;
      color: #fff;
      font-family: "Pretendard";
      overflow: hidden; /* í•œ í™”ë©´ ê³ ì • */
    }

    /* ìƒë‹¨ í—¤ë” (ì• ì±•í„°ë‘ í†¤ ë§ê²Œ) */
    header {
      width: 100%;
      padding: 18px 0;
      text-align: center;
      background: rgba(0, 0, 0, 0.9);
      font-size: 18px;
      font-weight: 500;
    }

    main {
      width: 100%;
      height: calc(100vh - 60px); /* í—¤ë” ì œì™¸ í™”ë©´ */
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      position: relative;
      overflow: hidden;
    }
    .nav {
        position: fixed;
        bottom: 20px;
        width: 100%;
        display: flex;
        justify-content: center;
        gap: 50px;
        z-index: 20;
    }

    .nav img {
        width: 120px;
        cursor: pointer;
    }
    .nav-btns {
      position: fixed;
      bottom: 0;         /* ğŸ“Œ í™”ë©´ ë°”ë‹¥ì— ë¶™ì„ */
      left: 0;
      width: 100%;       /* í™”ë©´ ì „ì²´ í­ ì‚¬ìš© */
      display: flex;
      justify-content: space-between; /* back = ì™¼ìª½ / forward = ì˜¤ë¥¸ìª½ */
      align-items: flex-end;
      padding: 0 30px 20px; /* ì¢Œìš° 30px, ì•„ë˜ 20px ì—¬ë°± */
      z-index: 9999;     /* ğŸ“Œ ìµœìƒë‹¨ ìš”ì†Œ */
      pointer-events: none; /* ê¸°ë³¸ í´ë¦­ ë§‰ê¸° */
    }

    /* ê°œë³„ ë²„íŠ¼ë§Œ í´ë¦­ ê°€ëŠ¥í•˜ê²Œ */
    .nav-btns a {
      pointer-events: all;
      display: block;
    }

    /* ë²„íŠ¼ í¬ê¸° ì¡°ì ˆ */
    .nav-btns img {
      height: 50px;  /* ì´ë¯¸ì§€ í¬ê¸° ì¡°ì ˆ */
      opacity: 0.9;
      transition: transform .2s, opacity .2s ease;
    }

    /* hover íš¨ê³¼ */
    .nav-btns img:hover {
      transform: scale(1.08);
      opacity: 1;
    }

    /* â”€â”€â”€â”€â”€ ë°°ê²½ ì‚¬ì§„ ì˜ì—­ â”€â”€â”€â”€â”€ */
    .mclaren-scene {
      position: relative;
      width: 100%;
      height: calc(100vh - 60px);
      background-image: url("ch3_rivary.png"); /* ğŸ‘‰ ë„ˆì˜ íŒŒì¼ëª…ìœ¼ë¡œ ìˆ˜ì • */
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
    }

    .mclaren-scene img.bg-photo {
      width: 100%;
      height: auto;
      display: block;
    }

    /* 1988 world drivers' champion winner ë©”ëª¨ */
    .champion-note {
      position: absolute;
      left: 11%;
      top: 20%;
      font-family: "Shadows Into Light", cursive;
      font-size: 32px;
      line-height: 1.3;
      white-space: pre-line;
    }

    /* ê²€ì€ ë°•ìŠ¤ ê³µí†µ */
    .info-box {
      position: absolute;
      left: 4%;
      background: rgba(0, 0, 0, 0.9);
      padding: 18px 26px;
      max-width: 420px;
      font-size: 20px;
      line-height: 1.6;
        
      opacity: 0;
      transform: translateY(10px);
      transition: opacity 0.4s ease-out, transform 0.4s ease-out;
    }

    .info-box strong {
      display: block;
      font-size: 16px;
      margin-bottom: 6px;
    }

    .info-box.top {
      top: 42%;
    }

    .info-box.bottom {
      top: 62%;
    }
    /* ê¸°ì¡´ 1ë²ˆì§¸ ì¥ë©´ì„ ìœ„ë¡œ ì‚´ì§ ë°€ê¸° ìœ„í•œ íŠ¸ëœì§€ì…˜ */
    .mclaren-scene {
      position: relative; /* ì´ë¯¸ ìˆì„ ìˆ˜ë„ ìˆëŠ”ë° ìˆìœ¼ë©´ ì¤‘ë³µ X */
      transition: transform 0.9s cubic-bezier(0.19, 1, 0.22, 1),
                  filter 0.9s cubic-bezier(0.19, 1, 0.22, 1);
      z-index: 1;
    }

    /* íƒ€ì´í•‘ ëë‚˜ë©´ ì ìš©í•  ìƒíƒœ */
    .mclaren-scene.slide-up {
      transform: translateY(-12%);   /* ì‚´ì§ ìœ„ë¡œ ë°€ê¸° */
      filter: brightness(0.8);
      transition-delay: 1s       /* ì¡°ê¸ˆ ì–´ë‘¡ê²Œ */
    }

    /* RIVALRY ì˜¤ë²„ë© ì¥ë©´ */
    .rivalry-scene {
      position: absolute;
      inset: 0;
      background-image: url("ch3_rivary2.png");  /* ğŸ‘‰ ë‘ ë²ˆì§¸ ì´ë¯¸ì§€ íŒŒì¼ ì´ë¦„ */
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
      transform: translateY(100%);   /* ì²˜ìŒì—” í™”ë©´ ì•„ë˜ì— ìˆ¨ê²¨ë‘  */
      transition: transform 1.5s cubic-bezier(0.19, 1, 0.22, 1);
      z-index: 2;
      transition-delay: 1s
    }
    /* chapter3.html - <style> ì„¹ì…˜ ë‚´ë¶€ì— ì¶”ê°€ */

    /* â–¼ [3] í”„ë¡œìŠ¤íŠ¸ ì¹´ë“œ ì»¨í…Œì´ë„ˆ ìŠ¤íƒ€ì¼ â–¼ */
    .prost-card-container {
        position: absolute;
        right: 5%; 
        bottom: 14%; 
        width: 420px; 
        background: #000;
        border: 3px solid #000; 
        box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        z-index: 10;
        padding: 0px;
        opacity: 0; /* íˆ¬ëª…í•˜ê²Œ ìˆ¨ê¹€ */
        pointer-events: none; /* í´ë¦­ ì´ë²¤íŠ¸ ë¹„í™œì„±í™” */
        transition: opacity 0.5s ease-out, transform 0.5s ease-out;
        }
    .prost-card-container.visible {
        opacity: 1; /* ë“±ì¥ ì‹œ ë³´ì´ê²Œ í•¨ */
        pointer-events: all; /* í´ë¦­ ì´ë²¤íŠ¸ í™œì„±í™” */
        transform: translateY(0);
    }

    .prost-image-wrapper {
        position: relative;
        overflow: hidden;
        /* ì´ë¯¸ì§€ ë¦¬ìŠ¤íŠ¸ë¥¼ ë‹´ì„ ì˜ì—­ (ìŠ¬ë¼ì´ë“œ êµ¬í˜„ì„ ìœ„í•´) */
    }

    .prost-photo {
        width: 100%;
        height: auto;
        display: block;
        padding: 0px;
        transition: transform 0.3s ease-in-out; /* ìŠ¬ë¼ì´ë“œ ì• ë‹ˆë©”ì´ì…˜ */
    }

    /* â–¼ [4] ìŠ¬ë¼ì´ë“œ ë²„íŠ¼ ìŠ¤íƒ€ì¼ â–¼ */
    .prost-nav-buttons {
        display: flex;
        justify-content: center;
        padding: 4px 0;
        background: #000; /* í•˜ë‹¨ ê²€ì • ë°” */
    }

    .nav-arrow {
        background: none;
        border: none;
        color: #fff;
        font-size: 20px;
        cursor: pointer;
        margin: 0 15px;
        padding: 5px 10px;
        transition: color 0.1s;
    }

    .nav-arrow:hover {
        color: #ff0000; /* í˜¸ë²„ ìƒ‰ìƒ (ì˜ˆì‹œ) */
    }

    /* ìœ„ë¡œ ìŠ¬ë¼ì´ë“œ ì¸ë  ë•Œ ìƒíƒœ */
    .rivalry-scene.show {
      transform: translateY(0);
    }

    .rivalry-card {
      position: absolute;
      left: 50%;
      top: 50%;
      transform: translate(-50%, -50%);
      background: rgba(0, 0, 0, 0.9);
      padding: 20px 40px;
      max-width: 520px;
      text-align: center;
      line-height: 1.6;
      font-size: 18px;
    }

    .rivalry-card strong {
      display: block;
      margin-bottom: 8px;
      font-size: 20px;
    }

    .play-video-btn {
      position: absolute;
      left: 50%;
      top: 130%;
      transform: translate(-50%, -50%);
      border: none;
      background: none;
      padding: 0;
      cursor: pointer;
      z-index: 10;
    }

    .play-video-btn img {
      display: block;
      width: 220px;       /* í•„ìš”í•˜ë©´ í¬ê¸° ì¡°ì ˆ */
      height: auto;
      filter: drop-shadow(0 0 12px rgba(0,0,0,0.6));
      transition: transform 0.2s ease, filter 0.2s ease;
    }

    .play-video-btn:hover img {
      transform: translateY(-2px) scale(1.03);
      filter: drop-shadow(0 0 20px rgba(0,0,0,0.8));
    }

    /* chapter3.html - <style> ì„¹ì…˜ ë‚´, .video-overlay ê·œì¹™ */
    .video-overlay {
        position: fixed;
        inset: 0;
        background: rgba(0, 0, 0, 0.8);
        /* â–¼ [ìˆ˜ì •] ìˆ˜ì§ ì¤‘ì•™ ì •ë ¬ë¡œ ë³µì› â–¼ */
        display: flex;
        
        align-items: center; /* ìˆ˜í‰ ì •ë ¬ */
        justify-content: flex-start; /* ìˆ˜ì§ ì •ë ¬ì„ ìƒë‹¨ìœ¼ë¡œ ë³€ê²½ */
        padding-top: 80px; /* í™”ë©´ ìƒë‹¨ì—ì„œ 50px ì—¬ë°± í™•ë³´ */ 

        opacity: 0;
        pointer-events: none;
        z-index: 9999;
        transition: opacity 0.3s ease;
        flex-direction: column; /* ìš”ì†Œë“¤ì„ ìˆ˜ì§ìœ¼ë¡œ ë°°ì¹˜ */
    }

    .video-overlay.visible {
      opacity: 1;
      pointer-events: all;
    }

    .video-inner {
      position: relative;
      max-width: 900px;
      width: 80vw;
      box-shadow: 0 20px 60px rgba(0,0,0,0.7);
      
      /* ë¹„ë””ì˜¤ê°€ ìº¡ì…˜ê³¼ Next ë²„íŠ¼ì„ ìˆ˜ìš©í•˜ë„ë¡ ë†’ì´ë¥¼ í™•ë³´ */
      display: flex;
      flex-direction: column;
  }
    

    .video-inner video {
      width: 100%;
      height: auto;
      display: block;
      background: #000;
    }

    .video-close {
      position: absolute;
      top: -52px;
      right: -2px;
      background: none;
      border: none;
      color: white;
      font-size: 52px !important;
      cursor: pointer;
      z-index: 9999;
      opacity: 0.8;
      transition: opacity .2s ease, transform .2s ease;
    }

    .chapter-nav {
      position: fixed;
      bottom: 12px;
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      gap: 40px;
      z-index: 30;
    }

    .nav-btn {
      cursor: pointer;
      transition: transform 0.2s ease, opacity 0.2s ease;
    }

    .nav-btn img {
      display: block;
      height: 40px;
      width: auto;
    }

    .nav-btn:hover {
      transform: translateY(-3px);
      opacity: 0.85;
    }
    /* ì²˜ìŒ í™”ë©´ì€ ì–´ë‘¡ê²Œ */
    .spotlight-overlay {
      position: fixed;
      inset: 0;
      background: black;
      pointer-events: none;
      z-index: 9999;
      transition: opacity 0.2s linear, background 0.05s linear; /* ğŸ‘ˆ opacityë„ ë¶€ë“œëŸ½ê²Œ */
      opacity: 1; /* ì²˜ìŒì—” ì™„ì „ ì–´ë‘ì›€ */
    }

    /* ë‹¤ ë°ì•„ì§„ ë’¤ ìƒíƒœ */
    .spotlight-overlay.fully-revealed {
      opacity: 0;
    }
    /* â–¶ ë¹„ë””ì˜¤ ì˜¤ë²„ë ˆì´ í•˜ë‹¨ next ë²„íŠ¼ ì˜ì—­ */
    .video-footer {
      margin-top: 18px;
      display: flex;
      justify-content: center;
    }

    .btn-next-scene {
      border: none;
      background: none;
      padding: 0;
      cursor: pointer;
    }

    .btn-next-scene img {
      display: block;
      width: 220px;   /* í•„ìš”í•˜ë©´ í¬ê¸° ì¡°ì ˆ */
    }

    /* â–¶ ë§ˆì§€ë§‰ ìŠ¤ì¦ˆì¹´ ì¥ë©´ ì˜¤ë²„ë ˆì´ */
    .final-scene-overlay {
      position: fixed;
      inset: 0;
      display: none;                 /* ê¸°ë³¸ì€ ìˆ¨ê¹€ */
      align-items: center;
      justify-content: center;
      z-index: 1300;
      background: rgba(0, 0, 0, 0.85);
    }

    .final-scene-overlay.visible {
      display: flex;
    }

    .final-scene {
      position: relative;
      width: 100%;
      height: 100%;
      background-image: url("ch3_last_scene.png"); /* ë°°ê²½ ì´ë¯¸ì§€ */
      background-size: cover;
      background-position: center;
    }

    /* ì˜¤ë¥¸ìª½ ì•„ë˜ ì„¤ëª… ì¹´ë“œ */
    .final-info-card {
      position: absolute;
      right: 5%;
      bottom: 11%;
      max-width: 470px;
      background: rgba(240, 238, 232, 0.95);
      color: #222;
      padding: 18px 24px;
      font-size: 18px;
      line-height: 1.6;
      font-weight: 500;
    }

    /* ì™¼ìª½ ìœ„ ì„œí‚· ê°€ì´ë“œ ì¢…ì´ (í•„ìš” ì—†ìœ¼ë©´ ì‚­ì œí•´ë„ ë¨) */
    .final-map {
      position: absolute;
      left: 0%;
      top: 0%;
      width: 440px;
      transform: rotate(-5deg);
    }
    /* chapter3.html - <style> ì„¹ì…˜ ë‚´ë¶€ì— ì¶”ê°€ */

    /* â–¼ [2] ë¹„ë””ì˜¤ í•´ì„¤ ìº¡ì…˜ ìŠ¤íƒ€ì¼ â–¼ */
    .video-caption-box {
        color: #333;
        max-width: 900px;
        padding: 15px 20px;
        font-size: 15px;
        line-height: 1.5;
        text-align: center;
        box-shadow: 0 4px 12px rgba(0,0,0,0.4);
        background: rgba(255, 255, 255, 0.9);
        margin-top: 30px;
        position: center;
        
        /* ì²˜ìŒì—ëŠ” ìˆ¨ê¹€ (ë¹„ë””ì˜¤ ì¬ìƒ ë²„íŠ¼ ëˆ„ë¥¼ ë•Œ ë‚˜íƒ€ë‚˜ê²Œ í•  ê²½ìš°) */
        opacity: 0; 
        transition: opacity 0.5s ease;
      
    }

    .video-caption-box.show {
        opacity: 1;
    }
    /* chapter3.html - <style> ì„¹ì…˜ ë‚´, .video-footer ê·œì¹™ */
    .video-footer {
        margin-top: 15px; /* ìº¡ì…˜ ë°•ìŠ¤ì™€ì˜ ê°„ê²© í™•ë³´ */
        display: flex;
        justify-content: center;
    }
    .intro-title {
    /* ... ê¸°ì¡´ ìŠ¤íƒ€ì¼ ... */
      position: fixed;
      inset: 0;
      width: 100vw;
      height: 100vh;
      
      /* â­â­ í™”ë©´ ì¤‘ì•™ ì •ë ¬ì„ ìœ„í•œ í•µì‹¬ ì½”ë“œ â­â­ */
      display: flex;             /* 1. Flex ì»¨í…Œì´ë„ˆë¡œ ì§€ì • */
      align-items: center;       /* 2. ìˆ˜ì§(ì„¸ë¡œ) ì¤‘ì•™ ì •ë ¬ */
      justify-content: center;   /* 3. ìˆ˜í‰(ê°€ë¡œ) ì¤‘ì•™ ì •ë ¬ */
      
      color: #fff;
      font-size: 22px;
      font-weight: 500;
  }
  /* chapter3.html - <style> ì„¹ì…˜ ë‚´ë¶€ (final-scene-overlay ì•„ë˜ì— ì¶”ê°€) */

    /* â–¼ ìŠ¤í‹°ì»¤ ê¸°ë³¸ ìŠ¤íƒ€ì¼ ë° ìˆ¨ê¹€ ìƒíƒœ â–¼ */
    .final-sticker {
        position: absolute;
        top: 50%;
        right: 100%; /* í™”ë©´ ì˜¤ë¥¸ìª½ ë°”ê¹¥ì—ì„œ ì‹œì‘ */
        transform: translateY(-50%) scale(0.8);
        opacity: 0;
        z-index: 1500;
        transition: opacity 0.1s ease;
    }

    .final-sticker img {
        width: 450px; /* ìŠ¤í‹°ì»¤ í¬ê¸° ì¡°ì • */
        height: auto;
    }

    /* â–¼ ìŠ¤í‹°ì»¤ ë“±ì¥ ì• ë‹ˆë©”ì´ì…˜ ì •ì˜ â–¼ */
    @keyframes stickerFlyIn {
        0% {
            opacity: 0;
            transform: translate(0, -50%) scale(0.4) rotate(5deg);
        }
        100% {
            opacity: 1;
            transform: translate(600px, -50%) scale(1) rotate(0deg);
        }
    }

    /* â–¼ ìŠ¤í‹°ì»¤ ë“±ì¥ ìƒíƒœ í´ë˜ìŠ¤ â–¼ */
    .final-scene-overlay.visible #finalSticker {
        animation: stickerFlyIn 1.2s cubic-bezier(0.1, 0.7, 0.4, 1.2) forwards;
    }
    /* chapter3.html - <style> ì„¹ì…˜ ë‚´ë¶€ (ì–´ë””ë“  ì¶”ê°€ ê°€ëŠ¥) */

    /* â­ [ì¶”ê°€] ë‹¤ìŒ ì¥ë©´ ë²„íŠ¼ ìœ„ì¹˜ ë° ìŠ¤íƒ€ì¼ â­ */
    .scene-transition-btn {
        position: absolute; 
        bottom: 50px; /* í™”ë©´ í•˜ë‹¨ì—ì„œ 30px ìœ„ */
        left: 50%; 
        transform: translateX(-50%); /* ì •í™•í•œ ìˆ˜í‰ ì¤‘ì•™ ì •ë ¬ */
        z-index: 100; 
        
        /* ìŠ¤íƒ€ì¼ */
        padding: 10px 20px; 
        font-size: 16px; 
        background: #fff; 
        color: #000; 
        border: none; 
        cursor: pointer; 
        
        display: none; /* JSì—ì„œ blockìœ¼ë¡œ ë³€ê²½í•  ì˜ˆì • */
        transition: all 0.2s ease;
    }

    .scene-transition-btn:hover {
        background: #e0e0e0;
    }

   
  </style>
</head>
<body>
  <audio id="bgm" src="ch3_bgm.mp3" loop></audio>
  <audio id="typingSfx" src="ch3_typing.mp3"></audio>
  <audio id="finalSceneSound" src="dadan.mp3" preload="auto"></audio>
  <header>
    ë§¥ë¼ë Œ ì´ì ê³¼ 'ì „ì„¤ì ì¸ ë¼ì´ë²Œ'ì˜ íƒ„ìƒ (1988ë…„ ~ 1989ë…„)
  </header>
  <div class="spotlight-overlay">
    <p class="intro-title"> ë§¥ë¼ë Œ ì´ì ê³¼ 'ì „ì„¤ì ì¸ ë¼ì´ë²Œ'ì˜ íƒ„ìƒ (1988ë…„ ~ 1989ë…„)</p>
  </div>

  <main>
    <section class="mclaren-scene">
      <!-- ğŸ‘‰ ì—¬ê¸° íŒŒì¼ ì´ë¦„ì„ ë„¤ê°€ ì €ì¥í•œ ì´ë¯¸ì§€ ì´ë¦„ìœ¼ë¡œ ë°”ê¿”ì¤˜ -->

      <!-- ì†ê¸€ì”¨ í…ìŠ¤íŠ¸ -->
      <div class="champion-note">
      1988 world drivers'
      champion winner
      </div>

      <!-- ìƒë‹¨ info ë°•ìŠ¤ -->
      <div class="info-box top">
        <strong>ë“œë¦¼íŒ€ ê²°ì„± (1988ë…„)</strong>
        <span id="infoTopText"></span>
      </div>

      <div class="info-box bottom">
        <strong>ì²« ì±”í”¼ì–¸ (1988ë…„)</strong>
        <span id="infoBottomText"></span>
      </div>
      <button id="nextSceneBtn" class="scene-transition-btn">
        ë‹¤ìŒ ì¥ë©´ â–¶
    </button>
    <div class="prost-card-container">
        <div class="prost-image-wrapper">
            <img id="prostImage" src="ch3_prost1.png" alt="ì•Œë­ í”„ë¡œìŠ¤íŠ¸ ì‚¬ì§„" class="prost-photo">
        </div>
        
        <div class="prost-nav-buttons">
            <button id="prostPrevBtn" class="nav-arrow prev">â—€</button>
            <button id="prostNextBtn" class="nav-arrow next">â–¶</button>
        </div>
    </div>
    </section>
    <section class="rivalry-scene">
      <div class="rivalry-card">
        <strong>ìˆ™ëª…ì˜ ëŒ€ê²° (1989ë…„)</strong>
        í•˜ì§€ë§Œ ë¼ì´ë²Œ ê´€ê³„ëŠ” ê·¹ì— ë‹¬í–ˆê³ , ì±”í”¼ì–¸ì‹­ì„ ë‘ê³ <br>ì¼ë³¸ ìŠ¤ì¦ˆì¹´ ì„œí‚·ì—ì„œ ì—´ë¦°
        ê²°ì •ì ì¸ ë ˆì´ìŠ¤ì—ì„œ<br>ë‘ ì„ ìˆ˜ëŠ” ì¶©ëŒ ì‚¬ê³ ë¥¼ ì¼ìœ¼í‚¤ë©° ì—­ì‚¬ì ì¸ ì¥ë©´ì„ ë‚¨ê²¼ë‹¤.
        <button id="playVideoBtn" class="play-video-btn">
        <img src="ch3_play_video.png" alt="play video">
      </button>
      </div>
      <!-- ğŸ¬ ë¹„ë””ì˜¤ ì˜¤ë²„ë ˆì´ -->
    <div id="videoOverlay" class="video-overlay">
      
      <div class="video-inner"> 
        <button class="video-close">&times;</button>
        <video id="rivalryVideo" src="ch3_suzuka.mp4" controls></video>
        
        <div id="videoCaption" class="video-caption-box">
            <p>
                1989ë…„ ìŠ¤ì¦ˆì¹´ ê·¸ë‘í”„ë¦¬ëŠ” ì„¸ë‚˜ì™€ í”„ë¡œìŠ¤íŠ¸ì˜ ì±”í”¼ì–¸ì‹­ì„ ê²°ì •ì§“ëŠ” ë ˆì´ìŠ¤ì˜€ë‹¤.<br>
                ë‹¹ì‹œ ë ˆì´ìŠ¤ë¥¼ ì§€ë°°í•˜ë˜ í”„ë¡œìŠ¤íŠ¸ë¥¼ ë”°ë¼ì¡ê¸° ìœ„í•´ ì„¸ë‚˜ëŠ” ë¬´ë¦¬í•œ ì¶”ì›”ì„ ì‹œë„í–ˆê³ , ì´ ì¶©ëŒë¡œ ì¸í•´ í”„ë¡œìŠ¤íŠ¸ëŠ” ë¦¬íƒ€ì´ì–´í•˜ì˜€ê³  ì„¸ë‚˜ëŠ” ë‹¤ì‹œ ì¶œë°œì„ í•˜ê²Œ ë˜ë©´ì„œ 1ìœ„ë¡œ ë“¤ì–´ì˜¨ ê²ƒì²˜ëŸ¼ ë³´ì˜€ë‹¤.
            </p>
        </div>
        
      </div>

          <!-- â–¶ ë¹„ë””ì˜¤ ì•„ë˜ next ë²„íŠ¼ -->
      <div class="video-footer">
      <button class="btn-next-scene">
        <img src="ch3_btn_next.png" alt="next">
      </button>
    </div>
    </div>

    </section>

    <!-- â–¶ ë§ˆì§€ë§‰ ìŠ¤ì¦ˆì¹´ ì¥ë©´ ì˜¤ë²„ë ˆì´ -->
    <div class="final-scene-overlay" id="finalScene">
      <div class="final-scene">
      <img class="final-map" src="ch3_suzuka_map.png" alt="Suzuka map"> -->
      <div id="finalSticker" class="final-sticker">
            <img src="crash_sticker.png" alt="Final Sticker" />
          </div>

        <div class="final-info-card">
          í•˜ì§€ë§Œ ê²°ë¡ ì ìœ¼ë¡œëŠ” ì„¸ë‚˜ê°€ ì‹¤ê²© ì²˜ë¦¬ë˜ë©´ì„œ í”„ë¡œìŠ¤íŠ¸ê°€ ì±”í”¼ì–¸ì„
          ì°¨ì§€í•˜ê²Œ ë˜ì—ˆê³ , ì´ ì‚¬ê±´ì€ F1 ì—­ì‚¬ìƒ ê°€ì¥ ë…¼ë€ì´ ë§ì€ ìˆœê°„
          ì¤‘ í•˜ë‚˜ë¡œ ê¸°ë¡ëœë‹¤.
        </div>
      </div>
    </div>

    <!-- back / forward ë²„íŠ¼ -->
    <div class="nav-btns">
      <a href="index.html" class="btn-back">
        <img src="btn_back.png" alt="back">
      </a>
      <a href="chapter4.html" class="btn-forwards">
        <img src="btn_forward.png" alt="forward">
      </a>
    </div>
  </main>
  <script>
    /* ================================
       ê¸°ë³¸ ìš”ì†Œë“¤ ì„ íƒ
    ================================= */
    const mclarenScene = document.querySelector(".mclaren-scene");
    const rivalryScene = document.querySelector(".rivalry-scene");

    const spotlight = document.querySelector(".spotlight-overlay");

    const bgm = document.getElementById("bgm");
    const typingSfx = document.getElementById("typingSfx");

    const infoTopEl = document.getElementById("infoTopText");
    const infoBottomEl = document.getElementById("infoBottomText");
    const nextSceneBtn = document.getElementById("nextSceneBtn"); // ìƒˆë¡œ ì¶”ê°€ëœ ë²„íŠ¼ ë³€ìˆ˜
    // â–¼ [3] ìƒˆë¡œìš´ ìº¡ì…˜ ìš”ì†Œ ë³€ìˆ˜ ì¶”ê°€ (ìŠ¤í¬ë¦½íŠ¸ ìƒë‹¨ì— ì¶”ê°€) â–¼
    const videoCaptionBox = document.getElementById("videoCaption");

    bgm.volume = 0;

    const finalSceneSound = document.getElementById("finalSceneSound"); 

    // â­ [ì¶”ê°€] ìµœì¢… ìŠ¤í‹°ì»¤ ìš”ì†Œ ì°¸ì¡°
    const finalSticker = document.getElementById("finalSticker");

    /* ================================
       ìƒíƒœê°’
    ================================= */
    let revealProgress = 0;
    let typingStarted = false;
    let musicStarted = false;

    /* ================================
       í…ìŠ¤íŠ¸ ì›ë¬¸
    ================================= */
    const infoTopFull =
      "ë‹¹ëŒ€ ìµœê³ ì˜ íŒ€ì´ì—ˆë˜ ë§¥ë¼ë Œ(McLaren)ìœ¼ë¡œ ì´ì í•˜ì—¬ ì•Œë­ í”„ë¡œìŠ¤íŠ¸ì™€ ë“€ì˜¤ë¥¼ ë§ºì—ˆë‹¤.";
    const infoBottomFull =
      "ì„¸ë‚˜ëŠ” í”„ë¡œìŠ¤íŠ¸ì™€ì˜ ì¹˜ì—´í•œ ê²½ìŸ ëì— 8ìŠ¹ì„ ê±°ë‘ë©° ìƒì•  ì²« ë“œë¼ì´ë²„ ì±”í”¼ì–¸ì‹­ ìš°ìŠ¹ì„ ì°¨ì§€";

    /* ================================
       ğŸµ BGM í˜ì´ë“œ ì¸/ì•„ì›ƒ
    ================================= */
    function fadeInMusic(duration = 5000) {
      const stepTime = 80;
      const steps = duration / stepTime;
      const volumeStep = 1 / steps;

      let currentVolume = 0;
      bgm.play().catch(() => {});

      const fade = setInterval(() => {
        currentVolume += volumeStep;
        if (currentVolume >= 1) {
          currentVolume = 1;
          clearInterval(fade);
        }
        bgm.volume = currentVolume;
      }, stepTime);
    }

    function fadeOutMusic(duration = 2000) {
      const stepTime = 80;
      const steps = duration / stepTime;
      const volumeStep = bgm.volume / steps;

      const fade = setInterval(() => {
        let v = bgm.volume - volumeStep;
        if (v <= 0) {
          bgm.volume = 0;
          bgm.pause();
          clearInterval(fade);
        } else {
          bgm.volume = v;
        }
      }, stepTime);
    }

    /* ================================
       âœï¸ íƒ€ì´í•‘ + íš¨ê³¼ìŒ
    ================================= */
    function startTypingSound() {
      typingSfx.currentTime = 0;
      typingSfx.volume = 0.35;
      typingSfx.loop = true;
      typingSfx.play().catch(() => {});
    }

    function stopTypingSound() {
      typingSfx.pause();
      typingSfx.currentTime = 0;
    }

    function typeText(element, fullText, speed, onComplete) {
      element.textContent = "";
      let i = 0;

      const typing = setInterval(() => {
        element.textContent += fullText.charAt(i);
        i++;
        if (i >= fullText.length) {
          clearInterval(typing);
          if (onComplete) onComplete();
        }
      }, speed);
    }

    /* ================================
       âœï¸ ë‘ ì¤„ íƒ€ì´í•‘ ì§„í–‰
    ================================= */
    function startTypingSequence() {
      if (typingStarted) return;
      typingStarted = true;

      const topBox = document.querySelector(".info-box.top");
      const bottomBox = document.querySelector(".info-box.bottom");

      topBox.style.opacity = 1;
      topBox.style.transform = "translateY(0)";

      startTypingSound();

      typeText(infoTopEl, infoTopFull, 120, () => {
        setTimeout(() => {
          bottomBox.style.opacity = 1;
          bottomBox.style.transform = "translateY(0)";

          typeText(infoBottomEl, infoBottomFull, 120, () => {
            stopTypingSound();

           if (nextSceneBtn) {
                   nextSceneBtn.style.display = 'block';}
            if (prostCardContainer) {
                    prostCardContainer.classList.add('visible');
                }

          });
        }, 350);
      });
    }
    // chapter3.html - <script> ì„¹ì…˜ ë‚´ë¶€ (ìŠ¤í¬ë¦½íŠ¸ í•˜ë‹¨ì— ì¶”ê°€)

    if (nextSceneBtn) {
        nextSceneBtn.addEventListener("click", () => {
            nextSceneBtn.style.display = 'none'; // ë²„íŠ¼ ìˆ¨ê¸°ê¸°
            
            // ë²„íŠ¼ì„ ëˆŒë €ì„ ë•Œë§Œ rivalry-sceneì´ ì˜¬ë¼ì˜¤ë„ë¡ ì²˜ë¦¬
            if (mclarenScene && rivalryScene) {
                mclarenScene.classList.add("slide-up"); // ê¸°ì¡´ ë°°ê²½ì„ ìœ„ë¡œ ì˜¬ë¦¬ê³  ì–´ë‘¡ê²Œ
                rivalryScene.classList.add("show");     // ë¼ì´ë²Œ ì¥ë©´ì„ ì•„ë˜ì—ì„œ ìœ„ë¡œ ì˜¤ë²„ë©
            }
        });
    }

    /* ================================
       ğŸ”¦ spotlight ë°ì•„ì§€ê¸° íš¨ê³¼
    ================================= */
    document.addEventListener("mousemove", (e) => {
      const x = e.clientX;
      const y = e.clientY;

      spotlight.style.background = `
        radial-gradient(circle at ${x}px ${y}px,
          transparent 0%,
          transparent 8%,
          black 18%,
          black 100%)
      `;

      if (revealProgress < 1) {
        revealProgress += 0.03;
        spotlight.style.opacity = 1 - revealProgress;

        if (revealProgress >= 1) {
          spotlight.classList.add("fully-revealed");

          setTimeout(() => {
            spotlight.style.display = "none";
            fadeInMusic();         
            startTypingSequence();
          }, 320);
        }
      }
    });

    /* ================================
       ğŸ¬ ë¹„ë””ì˜¤ overlay ì œì–´
    ================================= */
    const playVideoBtn = document.getElementById("playVideoBtn");
    const videoOverlay = document.getElementById("videoOverlay");
    const rivalryVideo = document.getElementById("rivalryVideo");
    const videoCloseBtn = document.querySelector(".video-close");

    const nextBtn = document.querySelector(".btn-next-scene");
    const finalScene = document.getElementById("finalScene");
    const finalClose = document.querySelector(".final-close");

    /* â–¶ ë¹„ë””ì˜¤ ì¬ìƒ ë²„íŠ¼ */
    playVideoBtn.addEventListener("click", () => {
      fadeOutMusic(2000);

      setTimeout(() => {
        videoOverlay.classList.add("visible");
        rivalryVideo.currentTime = 0;
        rivalryVideo.play();
        // â–¼ [ìˆ˜ì •/ì¶”ê°€] ìº¡ì…˜ ë°•ìŠ¤ ë…¸ì¶œ â–¼
        if (videoCaptionBox) videoCaptionBox.classList.add("show");
      }, 600);
    });

    /* â–¶ ë¹„ë””ì˜¤ ë‹«ê¸° ê³µí†µ í•¨ìˆ˜ */
    function closeVideo() {
      rivalryVideo.pause();
      rivalryVideo.currentTime = 0;
      videoOverlay.classList.remove("visible");
      if (videoCaptionBox) videoCaptionBox.classList.remove("show");
  }

    /* X ë²„íŠ¼ */
    videoCloseBtn.addEventListener("click", closeVideo);

    /* ì˜¤ë²„ë ˆì´ ë°°ê²½ í´ë¦­í•´ë„ ë‹«ê¸° */
    videoOverlay.addEventListener("click", (e) => {
      if (e.target === videoOverlay) closeVideo();
    });

    /* ================================
       â–¶ next ë²„íŠ¼ â†’ ë§ˆì§€ë§‰ ìŠ¤ì¦ˆì¹´ ì¥ë©´
    ================================= */
    nextBtn.addEventListener("click", () => {
      closeVideo();   

      // 1. ìµœì¢… ì¥ë©´ íš¨ê³¼ìŒ ì¬ìƒ
      if (finalSceneSound) {
        finalSceneSound.volume = 0.9;
        finalSceneSound.currentTime = 0;
        finalSceneSound.play().catch(e => console.log("Audio play blocked."));
      }               // ì˜ìƒ ë‹«ê¸°
      finalScene.classList.add("visible");  // ìŠ¤ì¦ˆì¹´ í™”ë©´ ì—´ê¸°
    });

    // chapter3.html - <script> ì„¹ì…˜ ë‚´ë¶€ (ìƒë‹¨ ë³€ìˆ˜ ì„ ì–¸ ë¶€ë¶„)

    // â–¼ [5] í”„ë¡œìŠ¤íŠ¸ ìŠ¬ë¼ì´ë“œ ê´€ë ¨ ë³€ìˆ˜ ì¶”ê°€ â–¼
    const prostImageEl = document.getElementById("prostImage");
    const prostPrevBtn = document.getElementById("prostPrevBtn");
    const prostNextBtn = document.getElementById("prostNextBtn");

    // ì´ë¯¸ì§€ ëª©ë¡ (ì¶”ê°€í•  ì´ë¯¸ì§€ íŒŒì¼ëª…ì„ ì—¬ê¸°ì— ë‚˜ì—´í•˜ì„¸ìš”)
    const prostImages = [
        "ch3_prost1.png", 
        "ch3_prost2.png","ch3_prost3.png","ch3_prost4.png"  //
        // í•„ìš”í•œ ë‹¤ë¥¸ ì´ë¯¸ì§€ íŒŒì¼ëª…ë„ ì—¬ê¸°ì— ì¶”ê°€
    ];
    let currentProstIndex = 0;


    // â–¼ [6] ìŠ¬ë¼ì´ë“œ ê¸°ëŠ¥ í•¨ìˆ˜ â–¼
    function updateProstImage(direction) {
        // direction: 1 for next, -1 for previous
        currentProstIndex += direction;

        if (currentProstIndex < 0) {
            currentProstIndex = prostImages.length - 1; // ëì—ì„œ ì²˜ìŒìœ¼ë¡œ
        } else if (currentProstIndex >= prostImages.length) {
            currentProstIndex = 0; // ì²˜ìŒì—ì„œ ëìœ¼ë¡œ
        }

        // ì´ë¯¸ì§€ ê²½ë¡œ ì—…ë°ì´íŠ¸
        if (prostImageEl) {
            prostImageEl.src = prostImages[currentProstIndex];
        }
    }


    // â–¼ [7] ë²„íŠ¼ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€ â–¼
    if (prostPrevBtn) {
        prostPrevBtn.addEventListener("click", () => {
            updateProstImage(-1);
        });
    }

    if (prostNextBtn) {
        prostNextBtn.addEventListener("click", () => {
            updateProstImage(1);
        });
    }
    // chapter3.html - <script> ì„¹ì…˜ ë‚´ë¶€ (ê°€ì¥ í•˜ë‹¨)

    // ... (ê¸°ì¡´ ìŠ¤í¬ë¦½íŠ¸ ì½”ë“œ) ...
    
    // ë„¤ë¹„ê²Œì´ì…˜ ë²„íŠ¼ ìš”ì†Œ ì„ íƒ (href ë§í¬ ëŒ€ì‹  JSë¡œ ì œì–´í•˜ê¸° ìœ„í•¨)
    const navBackBtn = document.querySelector(".btn-back");
    const navForwardBtn = document.querySelector(".btn-forwards");


    // 1. BACK ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸ ìˆ˜ì • (index.htmlë¡œ ì´ë™, íŒŒì¼ ì—°ê²° ìœ ì§€)
    if (navBackBtn) {
        navBackBtn.addEventListener("click", (e) => {
            e.preventDefault();
            
            // BGM í˜ì´ë“œ ì•„ì›ƒ (index.htmlë¡œ ì´ë™ ì‹œ BGMì´ ëŠê¸°ì§€ ì•Šê²Œ í•˜ë ¤ë©´)
            fadeOutMusic(600); 

            // 0.6ì´ˆ í˜ì´ë“œì•„ì›ƒ í›„ index.htmlë¡œ ì´ë™ (Chapter 2 ì„¹ì…˜ìœ¼ë¡œ ì§€ì •)
            setTimeout(() => {
                 // **index.htmlì˜ Chapter 2 ì„¹ì…˜ìœ¼ë¡œ ì´ë™í•˜ë„ë¡ ì¿¼ë¦¬ íŒŒë¼ë¯¸í„° ì‚¬ìš©**
                 window.location.href = "index.html?section=chapter2"; 
            }, 600); 
        });
    }

    // 2. FORWARD ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸ ìˆ˜ì • (chapter4.htmlë¡œ ì´ë™, íŒŒì¼ ì—°ê²° ìœ ì§€)
    if (navForwardBtn) {
        navForwardBtn.addEventListener("click", (e) => {
            e.preventDefault();
            
            // BGM í˜ì´ë“œ ì•„ì›ƒ (chapter4.htmlë¡œ ì´ë™ ì‹œ BGMì´ ëŠê¸°ì§€ ì•Šê²Œ í•˜ë ¤ë©´)
            fadeOutMusic(600); 

            // 0.6ì´ˆ í˜ì´ë“œì•„ì›ƒ í›„ chapter4.htmlë¡œ ì´ë™
            setTimeout(() => {
                 window.location.href = "chapter4.html"; 
            }, 600);
        });
    }
    // index.html - <script> ì„¹ì…˜ ë‚´ë¶€ (startTypingSequence í•¨ìˆ˜ ë‚´ë¶€)

    // â–¼ [ì¶”ê°€] í”„ë¡œìŠ¤íŠ¸ ì¹´ë“œ ì»¨í…Œì´ë„ˆ ë³€ìˆ˜ ì„ ì–¸ (ìŠ¤í¬ë¦½íŠ¸ ìƒë‹¨ ë³€ìˆ˜ ì„ ì–¸ë¶€ì— ì¶”ê°€) â–¼
    const prostCardContainer = document.querySelector(".prost-card-container");

   
    </script>
   
    </script>
</body>
</html>
